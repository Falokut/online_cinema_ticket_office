define(["@grafana/data","@grafana/runtime","react","@grafana/ui","@emotion/css","lodash"],((e,t,n,r,i,l)=>(()=>{"use strict";var o={389:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(559),i=n.n(r),l=n(476),o=n.n(l)()(i());o.push([e.id,".upper {\n  margin-top: 10px !important;\n}\n","",{version:3,sources:["webpack://./styles.css"],names:[],mappings:"AAAA;EACE,2BAA2B;AAC7B",sourcesContent:[".upper {\n  margin-top: 10px !important;\n}\n"],sourceRoot:""}]);const a=o},476:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,i,l){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(r)for(var a=0;a<this.length;a++){var u=this[a][0];null!=u&&(o[u]=!0)}for(var s=0;s<e.length;s++){var c=[].concat(e[s]);r&&o[c[0]]||(void 0!==l&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=l),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),t.push(c))}},t}},559:e=>{e.exports=function(e){var t=e[1],n=e[3];if(!n)return t;if("function"==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),l="/*# ".concat(i," */");return[t].concat([l]).join("\n")}return[t].join("\n")}},892:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var l={},o=[],a=0;a<e.length;a++){var u=e[a],s=r.base?u[0]+r.base:u[0],c=l[s]||0,p="".concat(s," ").concat(c);l[s]=c+1;var g=n(p),d={css:u[1],media:u[2],sourceMap:u[3],supports:u[4],layer:u[5]};if(-1!==g)t[g].references++,t[g].updater(d);else{var h=i(d,r);r.byIndex=a,t.splice(a,0,{identifier:p,updater:h,references:1})}o.push(p)}return o}function i(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var l=r(e=e||[],i=i||{});return function(e){e=e||[];for(var o=0;o<l.length;o++){var a=n(l[o]);t[a].references--}for(var u=r(e,i),s=0;s<l.length;s++){var c=n(l[s]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}l=u}}},311:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},60:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},192:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},760:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var l=n.sourceMap;l&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(l))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},865:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},644:e=>{e.exports=i},305:t=>{t.exports=e},545:e=>{e.exports=t},388:e=>{e.exports=r},980:e=>{e.exports=l},650:e=>{e.exports=n}},a={};function u(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={id:e,exports:{}};return o[e](n,n.exports,u),n.exports}u.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return u.d(t,{a:t}),t},u.d=(e,t)=>{for(var n in t)u.o(t,n)&&!u.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.nc=void 0;var s={};return(()=>{u.r(s),u.d(s,{plugin:()=>H});var e,t=u(305),n=u(545);!function(e){e.Top="Top",e.Bottom="Bottom"}(e||(e={}));const r={limitType:"Top",excludeEmptyGroupings:!1,includeGroupingLabels:!0,includeAggregateOption:!0,includeIncompleteIntervals:!0};var i;function l(e){switch(e){case"COUNT":return"Count";case"SUM":return"Sum";case"APPROX_COUNT_DISTINCT":return"Approx. Count Distinct";case"AVG":return"Avg";case"MAX":return"Max";case"MIN":return"Min";case"PERCENTILES":return"Percentiles"}}!function(e){e.Count="COUNT",e.Sum="SUM",e.Avg="AVG",e.Max="MAX",e.Min="MIN",e.Approx_Count_Distinct="APPROX_COUNT_DISTINCT",e.Percentiles="PERCENTILES"}(i||(i={}));var o=u(650),a=u.n(o),c=u(388),p=u(644),g=u(892),d=u.n(g),h=u(760),f=u.n(h),y=u(311),m=u.n(y),b=u(192),v=u.n(b),_=u(60),O=u.n(_),q=u(865),w=u.n(q),C=u(389),E={};function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){I(e,t,n[t])}))}return e}function P(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}E.styleTagTransform=w(),E.setAttributes=v(),E.insert=m().bind(null,"head"),E.domAPI=f(),E.insertStyleElement=O(),d()(C.Z,E),C.Z&&C.Z.locals&&C.Z.locals;const S=[{value:e.Top,label:"Top"},{value:e.Bottom,label:"Bottom"}];function D(e){return e?{label:e,value:e}:{}}function R(e){return e?{label:e.name,value:e}:{}}function F(e){if(null==e)return{};const t=function(e){if(Object.values(i).map((e=>e.valueOf())).indexOf(e)>=0)return e}(e);return{label:void 0===t?"":l(t),value:t}}class x extends o.PureComponent{onRunQuery(e){e.query.filter_definition&&null!==e.query.filter_definition&&void 0!==e.query.filter_definition&&(e.query.filterDefinitionName=e.query.filter_definition.name,e.query.selected_agg&&null!==e.query.selected_agg&&(e.query.filterDefinitionName=`${e.query.filterDefinitionName} - ${e.query.selected_agg.name}`,null!==e.query.calculation&&(e.query.filterDefinitionName=`${e.query.filterDefinitionName} - ${l(e.query.calculation)}`))),e.query.filterId&&""!==e.query.filterId&&null!==e.query.calculation&&e.query.aggregationId&&e.query.aggregationId>0&&(!e.query.limit||null==e.query.limit||e.query.limit&&e.query.limit>0)&&e.query.filter_definition&&null!==e.query.filter_definition&&(e.query.calculation!==i.Percentiles||e.query.calculation===i.Percentiles&&null!=e.query.percentile&&e.query.percentile>0&&e.query.percentile<=1)&&(e.query.excludeEmptyGroupings=!1,this.this_is_query_editor,this.props.onRunQuery())}getFilterDefinitions(){const e=[];return this.got_filters?this.known_filters:(this.props.datasource.getFilterDefinitions().then((t=>{t.forEach((t=>{null!=this.props.query.filterId&&this.props.query.filterId===t.id&&(this.props.query.filter_definition=t),e.push({label:t.name,value:t})}))})),this.known_filters=e,this.got_filters=!0,e)}getSpecificGroupingOptions(){return this.props.query.filter_definition&&null!=this.props.query.filter_definition.groupings?this.props.query.filter_definition.groupings.map((e=>D(e))):[]}getFDAggs(){return this.props.query.filter_definition?this.props.query.filter_definition.aggregations.map((e=>R(e))):[]}getCalculationOptions(){return this.props.query.selected_agg?this.props.query.selected_agg.calculations.map((e=>F(e))):[]}render(){var t;const r=this.this_is_query_editor&&this.props.query.filter_definition&&this.props.query.filter_definition.groupings&&this.props.query.filter_definition.groupings.length>0;let l,o,u,s=a().createElement(c.InlineField,{label:"Incomplete Intervals",labelWidth:22,tooltip:"Allow showing incomplete intervals."},a().createElement(c.InlineSwitch,{onChange:this.onIncompleteIntervalsChange,value:this.props.query.includeIncompleteIntervals})),p=a().createElement(c.InlineField,{label:"Recalculate Intervals",labelWidth:22,tooltip:"Should results be re-aggregated to fit, according to Query Options defined above?"},a().createElement(c.InlineSwitch,{onChange:this.onShouldRecalculateChange,value:this.props.query.shouldRecalculate}));if(this.this_is_query_editor&&(l=a().createElement(c.InlineFieldRow,null,s,p)),r){l=a().createElement(c.InlineFieldRow,null,a().createElement(c.InlineField,{label:"Long Result",labelWidth:15,tooltip:"Useful for displaying in tabular format, each grouping value will be represented as a separate column."},a().createElement(c.InlineSwitch,{onChange:this.onLongChange,value:this.props.query.longResult})),s,p,a().createElement(c.InlineField,{label:"Grouping Labels",labelWidth:20,tooltip:"When displaying series values, include grouping labels with their values"},a().createElement(c.InlineSwitch,{onChange:this.onGroupingLabelChange,value:null!==this.props.query.includeGroupingLabels&&this.props.query.includeGroupingLabels})));let e=(0,n.getTemplateSrv)().getVariables().map((e=>{const t={value:{id:e.id,name:e.name},label:e.label||e.name};if("query"!==e.type)return t;let n=e.query;if(void 0===n)return t;let r={id:n.rand_id||e.id,name:e.name};return null!==n.filterId&&void 0!==n.filterId&&null!==n.groupingName&&void 0!==n.groupingName&&""!==n.groupingName.trim()?{value:r,label:e.label||e.name,description:`${n.groupingName} on ${n.filterDefinitionName}`}:{value:r,label:e.label||e.name,description:"Incomplete variable definition",isDisabled:!0}}));e.unshift({value:{id:"$__agg",name:"$__agg"},label:"IGNORED",description:"do not include this grouping"});let t=[...new Set([...this.props.query.filter_definition.groupings,...Object.keys(this.props.query.grouping_filter_mapping||{})])];t.length>0&&(o=t.map((t=>{var n;const r=e.find((e=>{var n,r;return(null===(n=e.value)||void 0===n?void 0:n.id)===(null===(r=(this.props.query.grouping_filter_mapping||{})[t])||void 0===r?void 0:r.id)}))||null,i=null!==r&&"$__agg"===(null===(n=r.value)||void 0===n?void 0:n.id),l=null===r,o=(this.props.query.grouping_filter_includes||{})[t];return a().createElement("tr",{key:t},a().createElement("td",{style:{width:"min-content"}},a().createElement(c.InlineLabel,{width:"auto"},t)),a().createElement("td",{style:{width:"min-content",textAlign:"center",verticalAlign:"middle"}},a().createElement(c.Checkbox,{width:"auto",disabled:i||l,value:!i&&(!!l||void 0===o||o),onChange:e=>this.onGroupingFilterIncludeChange(e.currentTarget.checked,t)})),a().createElement("td",{style:{width:"100%"}},a().createElement(c.Select,{isClearable:!0,options:e,value:r,allowCustomValue:!1,onChange:e=>this.onGroupingFilterMapSelectChange(e,t)})))})),u=a().createElement(a().Fragment,null,a().createElement("div",{style:{display:"flex",marginRight:"auto",flexDirection:"column"}},a().createElement("div",{style:{minWidth:"600px",height:0}}),a().createElement("h4",null,"Grouping Filters"),a().createElement("table",null,a().createElement("thead",null,a().createElement("tr",null,a().createElement("th",{style:{width:"min-content"}},a().createElement(c.InlineLabel,null,"Grouping")),a().createElement("th",{style:{width:"min-content"}},a().createElement(c.InlineLabel,{tooltip:"Whether to include this grouping as a returned series to be charted, or just apply the filter"},"Include")),a().createElement("th",{style:{width:"100%"}},a().createElement(c.InlineLabel,null,"Filter")))),a().createElement("tbody",null,o)))))}let g=a().createElement(c.InlineField,{label:"Filter",labelWidth:this.this_is_query_editor?15:30,tooltip:"Specify Filter to work with"},a().createElement(c.Select,{allowCustomValue:!1,value:(d=this.props.query.filter_definition,d?{label:d.name,value:d}:{}),onChange:this.onFilterDefinitionChange,options:this.getFilterDefinitions(),onBlur:()=>{this.onRunQuery(this.props)},width:50}));var d;return a().createElement("div",{className:"upper"},a().createElement(c.HorizontalGroup,{width:"100%",align:"flex-start",justify:"space-between",spacing:"xs"},a().createElement("div",{style:{width:"95%"}},a().createElement(c.VerticalGroup,null,!this.this_is_query_editor&&a().createElement(c.InlineFieldRow,null,g),a().createElement(c.InlineFieldRow,null,this.this_is_query_editor&&g,!this.this_is_query_editor&&a().createElement(c.InlineField,{label:"Grouping",labelWidth:this.this_is_query_editor?15:30},a().createElement(c.Select,{allowCustomValue:!1,value:D(this.props.query.groupingName),onChange:this.onSpecificGroupingChange,options:this.getSpecificGroupingOptions(),onBlur:()=>{this.onRunQuery(this.props)},width:50})),!this.this_is_query_editor&&a().createElement(c.InlineFieldRow,null," ",a().createElement(c.InlineField,{tooltip:"Include an 'Aggregate All' option in this variable selector",label:"Include Aggregate Option",labelWidth:30},a().createElement(c.InlineSwitch,{onChange:this.onIncludeAggChange,value:this.props.query.includeAggregateOption})))),a().createElement(c.InlineFieldRow,null,this.this_is_query_editor&&a().createElement(c.InlineField,{label:"Aggregation",labelWidth:15},a().createElement(c.Select,{allowCustomValue:!1,value:R(this.props.query.selected_agg),onChange:this.onFDAggChange,options:this.getFDAggs(),onBlur:()=>{this.onRunQuery(this.props)},width:50}))),a().createElement(c.InlineFieldRow,null,this.this_is_query_editor&&null!=this.props.query&&a().createElement(c.InlineField,{label:"Calculation",labelWidth:15},a().createElement(c.Select,{allowCustomValue:!1,value:F(this.props.query.calculation),onChange:this.onAggChange,options:this.getCalculationOptions(),onBlur:()=>{this.onRunQuery(this.props)},width:this.props.query.calculation===i.Percentiles?20:50})),this.this_is_query_editor&&null!=(null===(t=this.props.query)||void 0===t?void 0:t.calculation)&&this.props.query.calculation===i.Percentiles&&a().createElement(c.InlineField,{label:"Percentile",tooltip:"Enter Percentile as Decimal between 0 and 1, so P99 should be '0.99'",labelWidth:15},a().createElement(c.Input,{type:"number",min:"0",max:"1",step:"0.05",value:null==this.props.query.percentile?void 0:this.props.query.percentile,onChange:this.onPercentileChange,width:20,onBlur:()=>{this.onRunQuery(this.props)}}))),this.this_is_query_editor&&a().createElement(c.InlineFieldRow,null,a().createElement(c.InlineField,{label:"Limit",labelWidth:15,tooltip:"Per time slice, only include the Top/Bottom N grouped values."},a().createElement(c.RadioButtonGroup,{value:this.props.query.limitType||e.Top,options:S,onChange:this.onLimitTypeChange})),a().createElement(c.InlineField,null,a().createElement(c.Input,{type:"number",min:"1",max:"999999",step:"1",value:null===this.props.query.limit?void 0:this.props.query.limit,onChange:this.onLimitChange,onBlur:()=>{this.onRunQuery(this.props)},width:20})),a().createElement(c.InlineField,{label:"Alias",labelWidth:15},a().createElement(c.Input,{type:"text",value:this.props.query.alias||void 0,onChange:this.onAliasChange,onBlur:()=>{this.onRunQuery(this.props)},width:50}))),l)),a().createElement(c.VerticalGroup,{align:"flex-start",hidden:!this.this_is_query_editor},u)))}constructor(e){super(e),I(this,"styles",A()),I(this,"this_is_query_editor",void 0),I(this,"known_filters",void 0),I(this,"got_filters",!1),I(this,"onFilterDefinitionChange",(e=>{const{onChange:t,query:n}=this.props,r=1===e.value.aggregations.length?e.value.aggregations[0]:null,i=null==r?null:1===r.calculations.length?r.calculations[0]:null;t(P(j({},n),{filterId:e.value.id,filter_definition:e.value,selected_agg:r,aggregationId:null==r?null:r.id,calculation:i,filterDefinitionName:e.value.name,grouping_filter_mapping:{},grouping_filter_mapping_str:""}))})),I(this,"onFDAggChange",(e=>{const{onChange:t,query:n}=this.props;let r=null===n.calculation?null:e.value.calculations.includes(n.calculation)?n.calculation:null;null==r&&1===e.value.calculations.length&&(r=e.value.calculations[0]),t(P(j({},n),{aggregationId:e.value.id,selected_agg:e.value,calculation:r}))})),I(this,"onAggChange",(e=>{const{onChange:t,query:n}=this.props;t(P(j({},n),{calculation:e.value}))})),I(this,"onPercentileChange",(e=>{const{onChange:t,query:n}=this.props;try{if(""!==e.target.value.trim()){let r=parseFloat(e.target.value);t(P(j({},n),{percentile:r}))}else t(P(j({},n),{percentile:null}))}catch(e){}})),I(this,"onLimitChange",(e=>{const{onChange:t,query:n}=this.props;try{if(""!==e.target.value.trim()){let r=parseInt(e.target.value,10);t(P(j({},n),{limit:r}))}else t(P(j({},n),{limit:null}))}catch(e){}})),I(this,"onAliasChange",(e=>{const{onChange:t,query:n}=this.props;try{""!==e.target.value.trim()?t(P(j({},n),{alias:e.target.value})):t(P(j({},n),{alias:null}))}catch(e){}})),I(this,"onLimitTypeChange",(e=>{const{onChange:t,query:n}=this.props;t(P(j({},n),{limitType:e}))})),I(this,"onIncompleteIntervalsChange",(e=>{const{onChange:t,query:n}=this.props;t(P(j({},n),{includeIncompleteIntervals:e.target.checked})),this.onRunQuery(this.props)})),I(this,"onShouldRecalculateChange",(e=>{const{onChange:t,query:n}=this.props;t(P(j({},n),{shouldRecalculate:e.target.checked})),this.onRunQuery(this.props)})),I(this,"onLongChange",(e=>{const{onChange:t,query:n}=this.props;t(P(j({},n),{longResult:e.target.checked})),this.onRunQuery(this.props)})),I(this,"onIncludeAggChange",(e=>{const{onChange:t,query:n}=this.props;t(P(j({},n),{includeAggregateOption:e.target.checked}))})),I(this,"onGroupingLabelChange",(e=>{const{onChange:t,query:n}=this.props;t(P(j({},n),{includeGroupingLabels:e.target.checked})),this.onRunQuery(this.props)})),I(this,"onSpecificGroupingChange",(e=>{const{onChange:t,query:n}=this.props;t(P(j({},n),{groupingName:e.value||null})),this.onRunQuery(this.props)})),I(this,"onGroupingFilterIncludeChange",((e,t)=>{const{onChange:n,query:r}=this.props;r.grouping_filter_includes&&null!==r.grouping_filter_includes||(r.grouping_filter_includes={}),r.grouping_filter_includes[t]=e,n(P(j({},r),{grouping_filter_includes:r.grouping_filter_includes})),this.onRunQuery(this.props)})),I(this,"onGroupingFilterMapSelectChange",((e,t)=>{const{onChange:n,query:r}=this.props;null==r.grouping_filter_mapping&&(r.grouping_filter_mapping={}),e&&null!=e&&e.value&&null!=e.value?(r.grouping_filter_mapping[t]=e.value,"$__agg"===e.value.id&&(void 0!==r.grouping_filter_includes&&null!==r.grouping_filter_includes||(r.grouping_filter_includes={}),r.grouping_filter_includes[t]=!1)):delete r.grouping_filter_mapping[t];let i="";Object.keys(r.grouping_filter_mapping).length>0&&(i=Object.entries(r.grouping_filter_mapping).map((e=>`${e[0]}="$${e[1].name}"`)).join("|")),n(P(j({},r),{grouping_filter_mapping:r.grouping_filter_mapping,grouping_filter_mapping_str:i,grouping_filter_includes:r.grouping_filter_includes})),this.onRunQuery(this.props)})),void 0===this.props.query.includeGroupingLabels&&(this.props.query.includeGroupingLabels=!0),void 0===this.props.query.includeIncompleteIntervals&&(this.props.query.includeIncompleteIntervals=!0),void 0===this.props.query.shouldRecalculate&&(this.props.query.shouldRecalculate=!1),void 0===this.props.query.longResult&&(this.props.query.longResult=!1),this.this_is_query_editor="query"===e.mode,this.onRunQuery=this.onRunQuery.bind(this),this.known_filters=[],void 0===this.props.query.rand_id&&(this.props.query.rand_id=Math.random().toString(20).substr(2,8));const{onChange:t,query:n}=this.props;t(P(j({},n),{datasourceId:e.datasource.id,excludeEmptyGroupings:!1,includeGroupingLabels:void 0===this.props.query.includeGroupingLabels||null===this.props.query.includeGroupingLabels||this.props.query.includeGroupingLabels,mode:e.mode}))}}const A=(0,c.stylesFactory)((()=>({upper:p.css`
      margin-top: 10px !important;
    `})));function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){T(e,t,n[t])}))}return e}function N(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function L(e){return a().createElement(x,N(G({},e),{query:N(G({},e.query),{refId:"tempvar"}),mode:"variables"}))}var k=u(980);function M(e,t,n,r,i,l,o){try{var a=e[l](o),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,i)}function Q(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var l=e.apply(t,n);function o(e){M(l,r,i,o,a,"next",e)}function a(e){M(l,r,i,o,a,"throw",e)}o(void 0)}))}}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){V(e,t,n[t])}))}return e}function W(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}class $ extends n.DataSourceWithBackend{applyTemplateVariables(e,t){let r=(0,n.getTemplateSrv)().getVariables();const i={};let l=!1;return e.fast_mode=!0,void 0!==e.grouping_filter_mapping&&null!=e.grouping_filter_mapping&&Object.entries(e.grouping_filter_mapping).forEach((n=>{let o=n[0],a=n[1],u={};if(u.grouping=o,"$__agg"===a.id)u.filters=[a.id],u.returnGroupingValues=!1,l=!0;else{null!=e.grouping_filter_includes&&void 0!==e.grouping_filter_includes[o]?u.returnGroupingValues=e.grouping_filter_includes[o]:u.returnGroupingValues=!0;let n=r.find((e=>{var t;return e.id===a.id||"query"===e.type&&(null===(t=e.query)||void 0===t?void 0:t.rand_id)===a.id}));var s;if(void 0!==n)void 0!==t[n.id]?u.filters=[null===(s=t[n.id])||void 0===s?void 0:s.value]:"string"==typeof n.current.value?u.filters=[n.current.value]:u.filters=n.current.value,l=!0}i[o]=u})),W(B({},e),{groupingFilters:l?Object.values(i).map((e=>e)):null})}getFilterDefinitions(){var e=this;return Q((function*(){return e.getResource("filterDefinitions")}))()}getDefaultQuery(e){return r}metricFindQuery(e,t){var n=this;return Q((function*(){return(yield n.postResource("groupingValues",e)).data.map((e=>({text:e})))}))()}constructor(e){super(e),this.variables={getType:()=>t.VariableSupportType.Custom,editor:L,query:e=>{const t=e.targets.map((e=>W(B({},e),{refId:e.refId||(0,k.uniqueId)("tempVar")})));return this.query(W(B({},e),{targets:t}))}}}}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){U(e,t,n[t])}))}return e}function K(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class X extends o.PureComponent{render(){return a().createElement("div",null,a().createElement(x,(e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Z(e,t,n[t])}))}return e}({},this.props),t=null!=(t={mode:"query"})?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e)));var e,t}constructor(e){super(e)}}const H=new t.DataSourcePlugin($).setConfigEditor((function(e){const{onOptionsChange:t,options:n}=e,{secureJsonFields:r}=n,i=n.secureJsonData||{};return a().createElement("div",{className:"gf-form-group"},a().createElement(c.InlineField,{label:"API Token",labelWidth:12},a().createElement(c.SecretInput,{isConfigured:r&&r.apiKey,value:i.apiKey||"",placeholder:"secure json field (backend only)",width:40,onReset:()=>{t(K(J({},n),{secureJsonFields:K(J({},n.secureJsonFields),{apiKey:!1}),secureJsonData:K(J({},n.secureJsonData),{apiKey:""})}))},onChange:e=>{t(K(J({},n),{secureJsonData:{apiKey:e.target.value}}))}})))})).setQueryEditor(X)})(),s})()));
//# sourceMappingURL=module.js.map